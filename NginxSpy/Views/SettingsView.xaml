<UserControl x:Class="NginxSpy.Views.SettingsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="16">
            <!-- 页面标题 -->
            <Grid Margin="0,0,0,24">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" Text="设置" Style="{StaticResource TitleTextStyle}" />
                
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button Content="保存设置" 
                            Style="{StaticResource SuccessButtonStyle}"
                            Command="{Binding SaveSettingsCommand}" />
                    
                    <Button Content="重置设置" 
                            Style="{StaticResource DangerButtonStyle}"
                            Command="{Binding ResetSettingsCommand}" />
                </StackPanel>
            </Grid>

            <!-- 监控设置 -->
            <materialDesign:Card Style="{StaticResource StatusCardStyle}" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="监控设置" Style="{StaticResource SubtitleTextStyle}" />
                    
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <!-- 刷新间隔 -->
                        <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,8,16">
                            <TextBlock Text="刷新间隔（秒）" Margin="0,0,0,4" />
                            <TextBox Text="{Binding MonitorRefreshInterval}" 
                                   materialDesign:HintAssist.Hint="监控数据刷新间隔" />
                        </StackPanel>

                        <!-- 自动启动 -->
                        <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,8,16">
                            <CheckBox IsChecked="{Binding MonitorAutoStart}" 
                                    Content="应用启动时自动开始监控" />
                        </StackPanel>

                        <!-- 显示通知 -->
                        <StackPanel Grid.Row="2" Grid.Column="0" Margin="0,0,8,16">
                            <CheckBox IsChecked="{Binding MonitorShowNotifications}" 
                                    Content="显示系统通知" />
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </materialDesign:Card>

            <!-- 界面设置 -->
            <materialDesign:Card Style="{StaticResource StatusCardStyle}" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="界面设置" Style="{StaticResource SubtitleTextStyle}" />
                    
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <!-- 主题 -->
                        <StackPanel Grid.Column="0" Margin="0,0,8,16">
                            <TextBlock Text="主题" Margin="0,0,0,4" />
                            <ComboBox SelectedValue="{Binding UITheme}" 
                                    materialDesign:HintAssist.Hint="选择界面主题">
                                <ComboBoxItem Content="浅色" Tag="Light" />
                                <ComboBoxItem Content="深色" Tag="Dark" />
                            </ComboBox>
                        </StackPanel>

                        <!-- 语言 -->
                        <StackPanel Grid.Column="1" Margin="8,0,0,16">
                            <TextBlock Text="语言" Margin="0,0,0,4" />
                            <ComboBox SelectedValue="{Binding UILanguage}" 
                                    materialDesign:HintAssist.Hint="选择界面语言">
                                <ComboBoxItem Content="简体中文" Tag="zh-CN" />
                                <ComboBoxItem Content="English" Tag="en-US" />
                            </ComboBox>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </materialDesign:Card>

            <!-- 日志设置 -->
            <materialDesign:Card Style="{StaticResource StatusCardStyle}" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="日志设置" Style="{StaticResource SubtitleTextStyle}" />
                    
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <!-- 日志级别 -->
                        <StackPanel Grid.Column="0" Margin="0,0,8,16">
                            <TextBlock Text="日志级别" Margin="0,0,0,4" />
                            <ComboBox SelectedValue="{Binding LogLevel}" 
                                    materialDesign:HintAssist.Hint="选择日志级别">
                                <ComboBoxItem Content="调试" Tag="Debug" />
                                <ComboBoxItem Content="信息" Tag="Information" />
                                <ComboBoxItem Content="警告" Tag="Warning" />
                                <ComboBoxItem Content="错误" Tag="Error" />
                            </ComboBox>
                        </StackPanel>

                        <!-- 保留天数 -->
                        <StackPanel Grid.Column="1" Margin="8,0,8,16">
                            <TextBlock Text="保留天数" Margin="0,0,0,4" />
                            <TextBox Text="{Binding LogRetentionDays}" 
                                   materialDesign:HintAssist.Hint="日志文件保留天数" />
                        </StackPanel>

                        <!-- 最大文件大小 -->
                        <StackPanel Grid.Column="2" Margin="8,0,0,16">
                            <TextBlock Text="最大文件大小（MB）" Margin="0,0,0,4" />
                            <TextBox Text="{Binding LogMaxFileSize}" 
                                   materialDesign:HintAssist.Hint="单个日志文件最大大小" />
                        </StackPanel>
                    </Grid>

                    <Button Content="清理旧日志" 
                            Style="{StaticResource WarningButtonStyle}"
                            Command="{Binding CleanupLogsCommand}"
                            HorizontalAlignment="Left" />
                </StackPanel>
            </materialDesign:Card>

            <!-- 数据库设置 -->
            <materialDesign:Card Style="{StaticResource StatusCardStyle}" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="数据库设置" Style="{StaticResource SubtitleTextStyle}" />
                    
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <!-- 自动备份 -->
                        <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,8,16">
                            <CheckBox IsChecked="{Binding DatabaseAutoBackup}" 
                                    Content="自动备份数据库" />
                        </StackPanel>

                        <!-- 备份间隔 -->
                        <StackPanel Grid.Row="0" Grid.Column="1" Margin="8,0,8,16">
                            <TextBlock Text="备份间隔（小时）" Margin="0,0,0,4" />
                            <TextBox Text="{Binding DatabaseBackupInterval}" 
                                   materialDesign:HintAssist.Hint="自动备份间隔" />
                        </StackPanel>

                        <!-- 备份保留天数 -->
                        <StackPanel Grid.Row="0" Grid.Column="2" Margin="8,0,0,16">
                            <TextBlock Text="备份保留天数" Margin="0,0,0,4" />
                            <TextBox Text="{Binding DatabaseBackupRetentionDays}" 
                                   materialDesign:HintAssist.Hint="备份文件保留天数" />
                        </StackPanel>
                    </Grid>

                    <StackPanel Orientation="Horizontal">
                        <Button Content="立即备份" 
                                Style="{StaticResource PrimaryButtonStyle}"
                                Command="{Binding BackupDatabaseCommand}" />
                        
                        <Button Content="恢复数据库" 
                                Style="{StaticResource WarningButtonStyle}"
                                Command="{Binding RestoreDatabaseCommand}" />
                    </StackPanel>
                </StackPanel>
            </materialDesign:Card>

            <!-- Nginx设置 -->
            <materialDesign:Card Style="{StaticResource StatusCardStyle}" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="Nginx设置" Style="{StaticResource SubtitleTextStyle}" />
                    
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <!-- 默认可执行文件路径 -->
                        <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,8,16">
                            <TextBlock Text="默认可执行文件路径" Margin="0,0,0,4" />
                            <TextBox Text="{Binding NginxDefaultPath}" 
                                   materialDesign:HintAssist.Hint="nginx.exe文件路径" />
                        </StackPanel>
                        
                        <Button Grid.Row="0" Grid.Column="1" 
                                Content="浏览" 
                                Style="{StaticResource PrimaryButtonStyle}"
                                Command="{Binding BrowseNginxPathCommand}"
                                VerticalAlignment="Bottom" />

                        <!-- 默认配置文件路径 -->
                        <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,8,16">
                            <TextBlock Text="默认配置文件路径" Margin="0,0,0,4" />
                            <TextBox Text="{Binding NginxDefaultConfigPath}" 
                                   materialDesign:HintAssist.Hint="nginx.conf文件路径" />
                        </StackPanel>
                        
                        <Button Grid.Row="1" Grid.Column="1" 
                                Content="浏览" 
                                Style="{StaticResource PrimaryButtonStyle}"
                                Command="{Binding BrowseConfigPathCommand}"
                                VerticalAlignment="Bottom" />

                        <!-- 自动发现 -->
                        <StackPanel Grid.Row="2" Grid.Column="0" Margin="0,0,8,16">
                            <CheckBox IsChecked="{Binding NginxAutoDiscovery}" 
                                    Content="自动发现新的nginx进程" />
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </materialDesign:Card>

            <!-- 性能设置 -->
            <materialDesign:Card Style="{StaticResource StatusCardStyle}" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="性能设置" Style="{StaticResource SubtitleTextStyle}" />
                    
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <!-- 启用性能监控 -->
                        <StackPanel Grid.Column="0" Margin="0,0,8,16">
                            <CheckBox IsChecked="{Binding PerformanceMonitoringEnabled}" 
                                    Content="启用性能监控" />
                        </StackPanel>

                        <!-- 数据保留时间 -->
                        <StackPanel Grid.Column="1" Margin="8,0,0,16">
                            <TextBlock Text="数据保留时间（小时）" Margin="0,0,0,4" />
                            <TextBox Text="{Binding PerformanceDataRetentionHours}" 
                                   materialDesign:HintAssist.Hint="性能数据保留时间" />
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </materialDesign:Card>

            <!-- 导入导出设置 -->
            <materialDesign:Card Style="{StaticResource StatusCardStyle}">
                <StackPanel>
                    <TextBlock Text="导入导出" Style="{StaticResource SubtitleTextStyle}" />
                    
                    <StackPanel Orientation="Horizontal">
                        <Button Content="导出设置" 
                                Style="{StaticResource PrimaryButtonStyle}"
                                Command="{Binding ExportSettingsCommand}">
                            <Button.ToolTip>
                                <ToolTip Content="将当前设置导出到文件" />
                            </Button.ToolTip>
                        </Button>
                        
                        <Button Content="导入设置" 
                                Style="{StaticResource PrimaryButtonStyle}"
                                Command="{Binding ImportSettingsCommand}">
                            <Button.ToolTip>
                                <ToolTip Content="从文件导入设置" />
                            </Button.ToolTip>
                        </Button>
                    </StackPanel>
                </StackPanel>
            </materialDesign:Card>

            <!-- 加载指示器 -->
            <Grid Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}">
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,32">
                    <ProgressBar Style="{StaticResource MaterialDesignCircularProgressBar}" 
                               IsIndeterminate="True" 
                               Width="50" Height="50" />
                    <TextBlock Text="处理中..." 
                             FontSize="16" 
                             HorizontalAlignment="Center" 
                             Margin="0,16,0,0" />
                </StackPanel>
            </Grid>
        </StackPanel>
    </ScrollViewer>
</UserControl>