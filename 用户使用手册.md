# NginxSpy 用户使用手册

## 概述

NginxSpy 是一个专业的 Nginx 配置管理和监控工具，提供直观的图形界面来管理 Nginx 实例、编辑配置文件和监控服务状态。

## 主要功能

### 1. Nginx 实例管理
- **自动检测**：自动扫描系统中运行的 Nginx 实例
- **手动添加**：支持手动添加自定义 Nginx 实例
- **实例信息**：显示实例名称、配置文件路径、进程ID等详细信息

### 2. 配置文件编辑
- **语法高亮**：提供 Nginx 配置文件语法高亮显示
- **结构化视图**：以树形结构展示配置文件层次
- **智能模板**：基于上下文提供可用的配置段模板
- **实时验证**：编辑时提供语法检查和结构验证

### 3. 进程监控
- **状态监控**：实时显示 Nginx 进程运行状态
- **进程管理**：支持启动、停止、重启 Nginx 服务
- **日志查看**：查看 Nginx 访问日志和错误日志

### 4. 系统设置
- **路径配置**：自定义 Nginx 可执行文件路径
- **编辑器设置**：配置代码编辑器选项
- **监控设置**：调整监控刷新频率等参数

## 详细操作指南

### 启动应用

1. 双击 `NginxSpy.exe` 启动应用
2. 首次启动会自动检测系统中的 Nginx 实例
3. 如果没有检测到实例，可以手动添加

### 添加 Nginx 实例

1. 点击主界面的 **"添加实例"** 按钮
2. 在弹出的对话框中填写：
   - **实例名称**：为实例指定一个易识别的名称
   - **配置文件路径**：选择 nginx.conf 文件的完整路径
   - **Nginx 可执行文件路径**：选择 nginx.exe 的路径
3. 点击 **"确定"** 完成添加

### 编辑配置文件

#### 基本编辑
1. 在实例列表中选择要编辑的实例
2. 切换到 **"配置编辑"** 标签页
3. 在左侧树形结构中选择要编辑的配置段
4. 在右侧编辑器中修改配置内容
5. 使用 `Ctrl+S` 保存更改

#### 添加新配置段
1. 在左侧树形结构中选择父级配置段
2. 在 **"配置段结构"** 区域选择要添加的配置段类型
3. 从下拉列表中选择合适的模板
4. 点击 **"添加"** 按钮
5. 在弹出的对话框中编辑配置内容
6. 点击 **"确定"** 完成添加

#### 智能模板功能
- **上下文感知**：根据当前选中的配置段，自动过滤可用的子配置段类型
- **模板预览**：每个模板都包含名称和描述，帮助选择合适的配置
- **结构验证**：确保添加的配置段符合 Nginx 语法规则

### 进程管理

1. 切换到 **"进程管理"** 标签页
2. 查看当前 Nginx 进程状态
3. 使用控制按钮：
   - **启动**：启动 Nginx 服务
   - **停止**：停止 Nginx 服务
   - **重启**：重启 Nginx 服务
   - **重新加载**：重新加载配置文件（不中断服务）

### 监控功能

1. 切换到 **"监控"** 标签页
2. 查看实时监控信息：
   - 进程状态和资源使用情况
   - 连接数统计
   - 请求处理统计
3. 查看日志文件内容

### 系统设置

1. 切换到 **"设置"** 标签页
2. 配置各项参数：
   - **Nginx 路径**：设置默认的 Nginx 可执行文件路径
   - **编辑器设置**：调整字体、主题等编辑器选项
   - **监控设置**：设置刷新频率、日志文件路径等
3. 点击 **"保存设置"** 应用更改

## 快捷键

- `Ctrl+S`：保存当前配置文件
- `Ctrl+N`：添加新的配置段
- `Ctrl+F`：在编辑器中查找文本
- `Ctrl+H`：在编辑器中替换文本
- `F5`：刷新监控数据

## 配置文件结构说明

### 主要配置段类型

- **main**：全局配置段，包含全局指令
- **events**：事件模块配置，处理连接相关设置
- **http**：HTTP 模块配置，包含 Web 服务器设置
- **server**：虚拟主机配置，定义网站或应用
- **location**：位置匹配配置，处理特定 URL 路径
- **upstream**：上游服务器配置，用于负载均衡

### 配置段层次关系

```
main
├── events
└── http
    ├── server
    │   └── location
    ├── upstream
    ├── map
    └── geo
```

## 故障排除

### 常见问题

1. **无法检测到 Nginx 实例**
   - 确保 Nginx 正在运行
   - 检查 Nginx 可执行文件路径是否正确
   - 以管理员权限运行 NginxSpy

2. **配置文件保存失败**
   - 检查文件权限，确保有写入权限
   - 确认配置文件路径正确
   - 检查磁盘空间是否充足

3. **语法错误**
   - 使用内置的语法检查功能
   - 参考 Nginx 官方文档确认语法
   - 检查括号、分号等符号是否匹配

4. **进程管理失败**
   - 确保以管理员权限运行
   - 检查 Nginx 可执行文件路径
   - 查看错误日志获取详细信息

### 日志文件位置

- **应用日志**：`%APPDATA%\NginxSpy\logs\`
- **Nginx 日志**：通常在 Nginx 安装目录的 `logs` 文件夹中

## 技术支持

如果遇到问题或需要帮助，请：

1. 查看本手册的故障排除部分
2. 检查应用日志文件
3. 确认 Nginx 版本兼容性
4. 联系技术支持团队

---

**版本信息**：NginxSpy v1.0  
**更新日期**：2024年1月  
**兼容性**：Windows 10/11, .NET 8.0